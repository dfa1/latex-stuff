\documentclass{article}
\RequirePackage{amssymb}
\RequirePackage{amsmath}
\usepackage{graphicx}
\usepackage[latin1]{inputenc}

\title{Esercizio 6}
\author{Davide Angelocola}

\begin{document}
\maketitle

\section{Esercizio}
Tre libri sono messi uno sopra l'altro a formare una pila. In ogni istante se ne sceglie a caso uno e si mette in cima alla pila lasciando invariata la posizione degli altri due. 

\begin{itemize}
    \item Assumendo che i libri siano contraddistinti con le lettere A, B e C: descrivere con una catena di Markov il sistema il stato è costituito in ogni istante dalla disposizione dei libri nella pila.
    \item Quando tempo occorre in media occorre se la catena è inizialmente nello stato (A,B,C)(dall'alto verso il basso) affinché il primo libro dall'alto sia quello contraddistinto dalla lettera C?
\end{itemize}

\section{Svolgimento primo punto}

Assumendo che la pila di libri sia inizialmente così composta:

$$
S_1 = \begin{pmatrix} 
A \cr 
B \cr
C \cr 
\end{pmatrix}
$$

Prendendo in fondo e ponendolo in cima alla pila, ovvero prendendo il libro C e mettendolo sopra A, si ottiene la seguente pila:

$$
S_2 = \begin{pmatrix} 
C \cr 
A \cr
B \cr 
\end{pmatrix}
$$

Pescando invece il libro B si ottiene una terza pila:

$$
S_3 = \begin{pmatrix} 
B \cr 
A \cr 
C \cr
\end{pmatrix}
$$

Ripetendo questo ragionamento con B e C in cima alla pila risulta evidente che  si hanno altre 2 configurazioni con B in cima e altre 2 per C. In totale si hanno 6 \footnote{ovvero $3!$ permutazioni semplici senza ripetizioni di 3 oggetti} possibili configurazioni. Le altre tre configurazioni sono:

$$
S_4 = \begin{pmatrix} 
C \cr 
B \cr 
A \cr
\end{pmatrix}
S_5 = \begin{pmatrix} 
B \cr 
C \cr 
A \cr
\end{pmatrix}
S_6 = \begin{pmatrix} 
A \cr 
C \cr 
B \cr
\end{pmatrix}
$$

Assegnando a ciascuna configurazione uno stato possiamo quindi esibire la matrice di transizione di questa Catena di Markov, con gli stati:

$$
P = \begin{pmatrix}
\frac{1}{3} & \frac{1}{3} & \frac{1}{3} & 0 & 0 & 0 \cr 
0 & \frac{1}{3} & 0 & 0 & \frac{1}{3} & \frac{1}{3} \cr 
\frac{1}{3} & 0 & \frac{1}{3} & \frac{1}{3} & 0 & 0 \cr 
0 & 0 & 0 & \frac{1}{3} & \frac{1}{3} & \frac{1}{3} \cr 
0 & 0 & \frac{1}{3} & \frac{1}{3} & \frac{1}{3} & 0 \cr 
0 & \frac{1}{3} & \frac{1}{3} & 0 & 0 & \frac{1}{3} \cr  
\end{pmatrix}
$$

e la relativa rappresentazione con il grafo:

\begin{figure}[h]
\centering
\includegraphics[scale=0.40]{cp_ex6_fig1.pdf}
\caption{Grafo delle transizioni}
\end{figure}

Dal grafo si evince che esso è fortemente connesso poiché esiste un cammino che collega ogni coppia di nodi. Risulta quindi che la catena è irrudicibile. Inoltre, essendo lo spazio degli stati finito, segue da un corollario del teorema sulle classi chiuse.

\section{Svolgimento secondo punto}

Rendendo assorbenti gli stati con C in cima alla pila si ottiene il seguente grafo delle transizioni:

\begin{figure}[h]
\centering
\includegraphics[scale=0.40]{cp_ex6_fig2.pdf}
\caption{Grafo delle transizioni modificato}
\end{figure}

La classe chiusa C conta quindi due stati assorbenti $S_2$ cioé $CAB$ e $S_4$ ovvero $CBA$. Possiamo ora impostare il sistema per il calcolo di $E_1[\tau_C]$:

$$x_i = 1 + \sum_{h \in T}{p_{ih}x_h}$$

per gli stati transienti $T = \{S_1, S_3, S_5, S_6\}$:

$$
\begin{cases}
 S_1 & x_1 = 1 + \frac{x_1}{3} + \frac{x_3}{3} \\
 S_3 & x_3 = 1 + \frac{x_3}{3} + \frac{x_1}{3} \\
 S_5 & x_5 = 1 + \frac{x_5}{3} + \frac{x_3}{3} \\
 S_6 & x_6 = 1 + \frac{x_6}{3} + \frac{x_3}{3} \\
\end{cases}
$$

Sottraendo la seconda dalla prima si ottiene che $x_1 = x_3$. Svolgendo i conti si dimostra che $x_1 = x_3 = x_5 = x_6 = 3$, per cui: 

$$
E_1[T_C] = 3.
$$ 
\end{document}
